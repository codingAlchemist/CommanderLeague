<div class="tournament-container">
  <header class="tournament-header">
    <h1>Commander Tournament Bracket</h1>
    <div class="header-actions">
      <button class="action-btn" (click)="toggleSignups()" [disabled]="isLoading">
        {{ showSignups ? 'ğŸ® View Tournament' : 'ğŸ“‹ View All Signups' }}
      </button>
      <button class="shuffle-btn" (click)="shuffleGroups()" [disabled]="isLoading">
        ğŸ”„ Shuffle Groups
      </button>
    </div>
  </header>

  <div class="loading" *ngIf="isLoading">
    <div class="spinner"></div>
    <p>Loading tournament groups...</p>
  </div>

  <div class="error" *ngIf="errorMessage">
    <p>{{ errorMessage }}</p>
  </div>

  <!-- All Signups View -->
  <div class="signups-view" *ngIf="showSignups && !isLoading">
    <div class="signups-header">
      <h2>All Player Signups</h2>
      <p>Total: {{ allSignups.length }} players (sorted by points)</p>
    </div>

    <div class="loading" *ngIf="isLoadingSignups">
      <div class="spinner"></div>
      <p>Loading signups...</p>
    </div>

    <div class="signups-list" *ngIf="!isLoadingSignups">
      <div class="signup-card" *ngFor="let player of allSignups; let i = index">
        <div class="signup-rank">{{ i + 1 }}</div>
        <div class="signup-info">
          <h3>{{ player.playerName }}</h3>
          <div class="signup-details">
            <p><strong>Deck:</strong> {{ player.deckName }}</p>
            <p><strong>Commander:</strong> {{ player.commander }}</p>
            <p><strong>Discord:</strong> {{ player.discordUsername }}</p>
            <p><strong>Email:</strong> {{ player.email }}</p>
          </div>
        </div>
        <div class="signup-points">
          <span class="points-label">Points</span>
          <span class="points-value">{{ player.points }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Tournament View -->
  <div class="tournament-view" *ngIf="!showSignups">
    <div class="tournament-info" *ngIf="!isLoading && groups.length > 0">
      <p><strong>Total Players:</strong> {{ players.length }}</p>
      <p><strong>Total Groups:</strong> {{ groups.length }}</p>
    </div>

    <div class="groups-container" *ngIf="!isLoading && groups.length > 0">
    <div class="group-card" *ngFor="let group of groups">
      <div class="group-header">
        <h2>Pod {{ group.groupNumber }}</h2>
        <span class="player-count">{{ group.players.length }} Players</span>
      </div>
      <div class="players-list">
        <div class="player-card" 
             *ngFor="let player of group.players; let i = index"
             [class.winner-selected]="isWinner(player, group.groupNumber)">
          <div class="player-position">{{ i + 1 }}</div>
          <div class="player-info">
            <h3>
              {{ player.playerName }}
              <span class="winner-badge" *ngIf="isWinner(player, group.groupNumber)">ğŸ† Winner</span>
            </h3>
            <div class="player-details">
              <p><strong>Deck:</strong> {{ player.deckName }}</p>
              <p><strong>Commander:</strong> {{ player.commander }}</p>
              <p><strong>Discord:</strong> {{ player.discordUsername }}</p>
            </div>
          </div>
          <div class="player-actions">
            <button class="winner-btn" 
                    [class.selected]="isWinner(player, group.groupNumber)"
                    (click)="selectWinner(player, group.groupNumber)" 
                    [title]="isWinner(player, group.groupNumber) ? 'Remove winner status' : 'Select as winner'">
              {{ isWinner(player, group.groupNumber) ? 'âœ“ Winner' : 'ğŸ‘‘ Winner' }}
            </button>
            <div class="player-points">
              <span class="points-label">Points</span>
              <span class="points-value">{{ player.points }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Winners Group -->
  <div class="winners-section" *ngIf="!isLoading && winnersGroup">
    <div class="winners-header">
      <h2>ğŸ† Winners Bracket</h2>
      <p>{{ winnersGroup.players.length }} winners advancing to the next round</p>
    </div>
    
    <div class="winners-container">
      <div class="group-card winners-group">
        <div class="group-header winners-group-header">
          <h2>Winners Pod</h2>
          <span class="player-count">{{ winnersGroup.players.length }} Players</span>
        </div>
        <div class="players-list">
          <div class="player-card" *ngFor="let player of winnersGroup.players; let i = index">
            <div class="player-position winner-position">{{ i + 1 }}</div>
            <div class="player-info">
              <h3>{{ player.playerName }} <span class="champion-badge">ğŸ†</span></h3>
              <div class="player-details">
                <p><strong>Deck:</strong> {{ player.deckName }}</p>
                <p><strong>Commander:</strong> {{ player.commander }}</p>
                <p><strong>Discord:</strong> {{ player.discordUsername }}</p>
              </div>
            </div>
            <div class="player-points">
              <span class="points-label">Points</span>
              <span class="points-value">{{ player.points }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="empty-state" *ngIf="!isLoading && groups.length === 0 && !errorMessage">
    <p>No players signed up yet.</p>
    <a href="#/sign-up">Go to Sign-Up Page</a>
  </div>
  </div>
</div>
